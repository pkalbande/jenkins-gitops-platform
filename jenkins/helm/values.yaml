jenkins:
  name: jenkins
  namespace: jenkins
  replicas: 1
  
  image: jenkins/jenkins
  tag: lts-jdk17
  imagePullPolicy: IfNotPresent
  
  serviceAccount: jenkins
  
  javaOpts: "-Xmx2048m -Xms1024m -Djenkins.install.runSetupWizard=false"
  
  resources:
    requests:
      cpu: "500m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"
  
  service:
    type: ClusterIP
  
  persistence:
    enabled: true
    claimName: jenkins-pvc
    size: 20Gi
    storageClass: efs-sc
  
  ingress:
    enabled: true
    className: alb
    annotations:
      kubernetes.io/ingress.class: alb
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
      alb.ingress.kubernetes.io/ssl-redirect: '443'
      alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:region:account:certificate/id
    hosts:
      - host: jenkins.yourdomain.com
        paths:
          - path: /
            pathType: Prefix
            port: 8080
    tls:
      - secretName: jenkins-tls
        hosts:
          - jenkins.yourdomain.com
  
  casc:
    config: |
      jenkins:
        systemMessage: "Jenkins GitOps Platform - Managed by Configuration as Code"
        numExecutors: 0
        mode: EXCLUSIVE
        securityRealm:
          local:
            allowsSignup: false
        authorizationStrategy:
          loggedInUsersCanDoAnything:
            allowAnonymousRead: false
        clouds:
          - kubernetes:
              name: kubernetes
              serverUrl: https://kubernetes.default
              namespace: jenkins
              jenkinsUrl: http://jenkins:8080
              jenkinsTunnel: jenkins:50000
              containerCapStr: 10
              podLabels:
                - key: jenkins
                  value: agent
              templates:
                - name: jnlp-agent
                  namespace: jenkins
                  label: jnlp-agent
                  containers:
                    - name: jnlp
                      image: jenkins/inbound-agent:latest
                      workingDir: /home/jenkins/agent
                      ttyEnabled: true
                      resourceRequestCpu: 200m
                      resourceRequestMemory: 256Mi
                      resourceLimitCpu: 500m
                      resourceLimitMemory: 512Mi
      unclassified:
        location:
          url: https://jenkins.yourdomain.com
